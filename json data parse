import json
import requests

#get request to NIST API for McAfee/ENS CVE data
url = "https://services.nvd.nist.gov/rest/json/cves/1.0?startIndex=20&resultsPerPage=50&keyword=mcafee+endpoint"
response = requests.get(url)

#read json data into json python format
read_json = response.json() 

#define file to be created
create_file = '/content/drive/My Drive/test/McafeeCVE2.json'

#read thru the first 2 dicts in the json 
results = read_json['result']['CVE_Items']

#create json file in write mode
with open(create_file, 'w') as new_file:
  #loop through the nested list
  for cve in results:
    #drill into the nested dicts to capture data points
    cve_id = cve['cve']['CVE_data_meta']['ID']
    cve_desc = cve['cve']['description']['description_data']
    for desc in cve_desc:
        desc_value = desc['value']        
    #define var with captured data points in a readable format
    group = f"\nCVE:{cve_id} \nDescription: {desc_value} \n"
    #write var to created json file. File is auto saved and closed
    new_file.write(group)




	



